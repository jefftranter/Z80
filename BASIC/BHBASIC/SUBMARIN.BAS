00001 DIM A$(8,60)
00002 GOSUB 660:S1=D1:GOSUB 660:U5=D1:GOSUB 660:U7=D1:GOSUB 661:S2=D2
00003 GOSUB 661:U6=D2:GOSUB 661:U8=D2:T6=8:T9=6:F=2:T=0
00004 IF S1=0 THEN S1=1
00005 IF S2=0 THEN S2=1
00009 PRINT TAB(20)"**   COMMANDS   **":PRINT "(1) HELM CONTROL";
00011 PRINT TAB(30)"DIRECTIONS":PRINT "(2) SONAR/RADAR PLOT";
00013 PRINT TAB(30)"8  1  2":PRINT "(3) WEAPONS CONTROL";:PRINT TAB(30)"7  *  3"
00015 PRINT TAB(30)"6  5  4":PRINT :PRINT :GOTO 50
00030 IF U5=0 AND U6=0 GOTO 35
00031 V2=1:GOSUB 660:GOSUB 625:U5=U5+Y:U6=U6+X:IF U5<=0 THEN U5=1
00032 IF U5>8 THEN U5=8
00033 IF U6<=0 THEN U6=1
00034 IF U6>60 THEN U6=60
00035 IF U7=0 AND U8=0 GOTO 40
00036 V2=1:GOSUB 660:GOSUB 625:U7=U7+Y:U8=U8+X:IF U7<=0 THEN U7=1
00037 IF U7>8 THEN U7=8
00038 IF U8<=0 THEN U8=1
00039 IF U8>60 THEN U8=60
00040 IF U5=0 AND U6=0 AND U7=0 AND U8=0 GOTO 680
00041 IF F>0 GOTO 50
00042 V1=1:I1=U5:I2=U6:T3=S1:T4=S2:GOSUB 650:IF T5=1 GOTO 46
00043 I1=U7:I2=U8:GOSUB 650:IF T5<>1 GOTO 48
00046 FOR C=1 TO 5:PRINT CHR$(7);:PAUSE (100):NEXT C:PRINT "TORPEDO HIT !";
00047 PAUSE (500):GOSUB 670:PRINT "YOU JUST SUNK!":GOTO 683
00048 IF T6=0 AND T9=0 GOTO 683
00049 IF T>=25 GOTO 683
00050 U1=0:U2=0:U3=0:U4=0:F=F-1:INPUT "COMMAND > ";Z
00052 IF Z=2 GOTO 200
00054 IF Z=3 GOTO 300
00060 IF Z<=0 OR Z>3 THEN PRINT "INVALID COMMAND":GOTO 50
00100 T=T+1:PRINT :GOSUB 605:PRINT "HELM CONTROL":INPUT "ENTER COURSE > ";D1
00104 IF D1<=0 OR D1>8 THEN PRINT "INVALID INPUT":GOTO 102
00106 V2=1:GOSUB 625:S1=S1+Y:S2=S2+X:IF S1<=0 THEN S1=1
00107 IF S1>8 THEN S1=8
00108 IF S2<=0 THEN S2=1
00109 IF S2>60 THEN S2=60
00110 PRINT "COURSE ACKNOWLEDGED":GOSUB 605:PRINT :GOTO 30
00200 PRINT "SONAR ACTIVE - STANDBY FOR PLOT - ELAPSED TIME ";T;" HOURS"
00203 GOSUB 605:V1=3:I1=S1:I2=S2:T3=U5:T4=U6:GOSUB 650
00204 IF T5=1 THEN U1=U5:U2=U6:T5=0
00206 T3=U7:T4=U8:GOSUB 650
00208 IF T5=1 THEN U3=U7:U4=U8:T5=0
00210 FOR A=1 TO 8:FOR B=1 TO 60:A$(A,B)=" ":NEXT B:A$(S1,S2)="*"
00211 A$(U1,U2)="S":A$(U3,U4)="S":FOR B=1 TO 60:PRINT A$(A,B);
00212 NEXT B:FOR B=1 TO 60:A$(A,B)="":NEXT B:PRINT :NEXT A:GOSUB 605:GOTO 30
00300 GOSUB 605:PRINT "WEAPONS STATUS: ";T6;" ASROC'S ";T9;" TORPEDO'S"
00302 PRINT "WEAPONS:";:PRINT TAB(20)"(0) ABORT":PRINT TAB(20)"(1) TORPEDO"
00303 PRINT TAB(20)"(2) ASROC"
00305 INPUT "SELECT > ";Z
00307 IF Z=0 GOTO 334
00308 IF Z<0 OR Z>2 THEN PRINT "INVALID INPUT":GOTO 305
00309 IF Z=2 GOTO 329
00310 IF T9=0 THEN PRINT "ALL TUBES EMPTY":GOTO 305
00311 LINE INPUT "LAUNCH TORPEDO? (Y/N) > ";Z$
00312 IF Z$="N" GOTO 305
00314 GOSUB 670:PRINT "TORPEDO LAUNCHED - ";:GOSUB 671:T9=T9-1:V1=2:I1=S1
00316 I2=S2:GOSUB 317:GOTO 334
00317 T3=U5:T4=U6:GOSUB 650
00318 IF T5=1 THEN U1=0:U2=0:U5=0:U6=0:T5=0:GOTO 325
00320 T3=U7:T4=U8:GOSUB 650
00322 IF T5=1 THEN U3=0:U4=0:U7=0:U8=0:T5=0:GOTO 325
00324 PRINT "SHOT EVALUATED AS A MISS":GOTO 326
00325 PRINT "HIT - SUBMARINE DESTROYED"
00326 RETURN 
00329 IF T6=0 THEN PRINT "ASROC LAUNCHER EMPTY":GOTO 305
00330 INPUT "ASROC ARMED - ENTER DIRECTION > ";D1
00331 IF D1<=0 OR D1>8 THEN PRINT "INVALID INPUT":GOTO 330
00332 V2=3:T6=T6-1:GOSUB 670:PRINT "ASROC FIRED - ";:GOSUB 671:GOSUB 625
00333 I1=S1+Y:I2=S2+X:V1=1:GOSUB 317
00334 GOSUB 605:PRINT :GOTO 30
00605 FOR A=1 TO 60:PRINT "-";:NEXT A:PRINT :RETURN 
00625 IF D1=1 THEN Y=-1*V2:X=0
00627 IF D1=2 THEN Y=-1*V2:X=4*V2
00629 IF D1=3 THEN Y=0:X=4*V2
00631 IF D1=4 THEN Y=1*V2:X=4*V2
00633 IF D1=5 THEN Y=1*V2:X=0
00635 IF D1=6 THEN Y=1*V2:X=-4*V2
00637 IF D1=7 THEN Y=0:X=-4*V2
00639 IF D1=8 THEN Y=-1*V2:X=-4*V2
00641 RETURN 
00650 FOR T1=I1-1*V1 TO I1+1*V1:FOR T2=I2-4*V1 TO I2+4*V1
00654 IF T1=T3 AND T2=T4 THEN T5=1
00656 NEXT T2:NEXT T1:RETURN 
00660 D1=INT(8*RND(1)):RETURN 
00661 D2=INT(60*RND(1)):RETURN 
00670 E=5:FOR C=1 TO 5:PRINT E;:PAUSE (1000):PRINT "-";:E=E-1:NEXT C:RETURN 
00671 PRINT "STANDBY FOR EVALUATION":RETURN 
00680 PRINT "CONGRATULATIONS ON SINKING BOTH SUBMARINES. WELL DONE!"
00683 LINE INPUT "GAME OVER. DO YOU WANT TO PLAY AGAIN? (Y/N) ";Z$
00684 IF Z$="Y" GOTO 2
00685 PRINT "VERY WELL. SEE YOU NEXT TIME"
00686 END 
